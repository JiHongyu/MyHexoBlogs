---
title: Combinatorial Mathematics
date: 2016-12-06 23:36:39
tags: ['组合数学']
---

# 前言

[课程链接](http://www.xuetangx.com/courses/course-v1:TsinghuaX+60240013_tv+2015_T1/info, "学堂在线")

[OEIS数据库](http://oeis.org/, "The On-Line Encyclopedia of Integer Sequences")

<!--more-->

# Chapter 1~2: 组合数学初步

### 基本计算规则（注意事件的独立性）：

+ 加法规则：考虑事件的成分（类别）
+ 乘法规则：考虑事件的步骤
+ 减法法则：考虑事件的对立面
+ 除法法则：等价类（重复类）的划分

### 组合问题的经典模型1：小球选取模型

描述：将 $n$ 个 **不同** 的小球选择 $r$ 个放入 $r$ 个盒子中，存在多少种不同的选取方法。从这个问题我们可以引入组合数学的两个基本的计数问题。

#### 排列（Permutation）：盒子有编号，取出的小球有顺序

+ 基于乘法规则递推关系式：$P(n,r)=n\times P(n-1,r-1)$

+ 基于加法规则的递推关系式：$P(n,r)=P(n-1,r)+P(n-1,r-1)$


#### 组合（Combination）：盒子无编号，取出的小球无顺序

重要公式：

$C(n,l)\times C(l,r)=C(n,r)\times C(n-r,l-r)$

### 组合问题的经典模型2：格路模型

描述：从坐标(0,0)点到(m,n)点的所有格路径的条数是多少。

解答：$C(m+n,m)$

杨辉三角，二项式定理

Chu-Vandermonde 等式
\[
    \dbinom{m+n}{r} = \sum_{k=0}^{r} \dbinom{m}{k}\cdot\dbinom{n}{r-k}
\]

### 各种排列

圆排列：从 $n$ 个 **不同** 的元素取出 $r$ 个构成一个圈，一共有多少种取法。

解答：将圆排列转换成线排列，再去掉重复的计数（除法规则）。答案：$P(n,r)/r$

项链排列：圆排列的基础上考虑镜像对称。

解答：$P(n,r)/2r$

#### 多重排列

元素的个数是有限的，元素是可以重复选取的（多项式定理）。

全排列定义：若干元素，$r_1$个 1，$r_2$个 2···$r_t$个 t，其元素个数值和为 $n$，则其全排列数记为：
\[
    P(n;r_1,r_2,...,r_t)=\frac{n!}{r_1!r_2!...r_t!} \qquad \sum_{i=1}^t r_i = n
\]

其思路运用了除法规则，类比于圆排列。

排列组合计算技巧：相邻问题用捆绑发；分区域问题用隔板法


#### 可重组合

$n$ 个不通用的元素中可重复地选取 $r$ 个元素，则取法数有 $C'(n,r)=C(n+r-1,r)$

证明方法：

+ 方法1：基于序列相加的组合证明。（基本方法）
+ 方法2：转换问题：在 $n$ 个不同的元素去 $r$ 个进行组合，等价于吧 $r$ 个元素分成 $n$ 个区域。（高级抽象）

#### 不相邻组合

$n$ 个不通用的元素中不相邻地选取 $r$ 个元素，则取法数有 $C''(n,r)=C(n-r+1,r)$

### 基本排列组合简单模型小结

| 类型       | 例子            | 顺序要求 | 重复要求|计数       |
| -----------|:-----------:|:--------:|:-------:|-----------|
| 无重组合   |n个球取r个   | No       | No      |$C(n,r)$   |
| 无重排列   |n个球取r个   | Yes      | No      |$P(n,r)$   |
| 可重组合   |线性方程求解个数| No    | Yes     |$C(n+r-1,r)$   |
| 可重排列   |单词组合   | Yes      | Yes      |$n^r$   |
| 多重全组合 |$r_1$个a，$r_2$个b组成的n位串 | Yes | Yes |$\frac{n!}{r_1!r_2!}$   |

注意：可重的意思是元素是无限的，多重的意思是元素的个数是有限的（但不限于1）。

### 全排列生成算法

#### 原始递归法

由 n-1 个元素排列生成 n 个元素的排列 

#### 字典序法

基于字典序生成全排列，其思想是序列前缀尽量不变，只是微微增大后缀部分。算法步骤如下：

1. 从右至左扫描序列，找出序列的第一个下降点
2. 在该下降点的右边找出一个最小变化点
3. 交换这两个元素，形成下一个排列

#### SJT(Steinhaus–Johnson–Trotter)算法

局部移动。

设[a1,a2 ... aN] 每一项都有向左或向右两个移动方向。

1. 初始化所有移动方向向左；
2. 如果移动方向的值比自己小，就可移动，比如 <1 >2 <3, 每个数字前箭头的方向表示该数字的移动方向，3可以移动，2和1不可移动；
3. 移动最大的可以动项，在上面例子中就是数字3；
4. 将所有比移动项大的项方向反转，重复第三步，直到不能移动为止。

### Stirling数估计
\[
    n! \sim \sqrt{2\pi n}(\frac{n}{e})^n
\]


# Chapter 3: 母函数（生成函数）初步

母函数是形式幂级数，是一种计数工具其形式为：
\[
    G(x) = c_0 + c_1x + c_2x^2 + c_3x^3 + ...
\]

母函数的一项 $cx_k$：幂级数 $k$ 表示实际 **对象个数** 的抽象；系数 $c$：表示在该 **对象个数** 下的计数。

母函数实际上蕴含着一种映射关系

母函数运算中蕴含着乘法规则和加法规则。

母函数就是一系列用来展示一串数字序列的挂衣架。

#### 砝码称重问题

1g, 2g, 3g, 4g 砝码各一个，问一共有多少种称重方式。

### 整数拆分问题

有序拆分：$C(n-1,r-1)$

无序拆分：把一个整数拆分成若干部分之和，相当于将 $n$ 个 **无区别** 的小球放入 $r$ 个 **无区别** 的盒子里。

注意无序拆分与可重组合模型的区别：无需拆分中的基本元素是 **对象的个数**，而可重组合模型是 **不同类别对象的个数**。举个例子：在取小球模型中，整数拆分是将小球放入不同的盒子里；而可重模型是将不同颜色的小球放入同一个盒子里。

模式方法

Birch and Swinnerton-Dyer 猜想


Ferrers 图像

整数拆分的形象几何表示。

性质：

+ 整数拆分中，最大数是 $k$ 和 $k$ 个数之和的拆分数是相等的。
+ 若整数 $n$ 能拆分成若干个奇数之和，则其 Ferrers 图像是自共轭的。

母函数与递推关系（差分方程）

汉诺塔问题

求 $n$ 位十进制数中出现偶数个5的数的个数

求解：

令 $a_n$ 表示 $n$位十进制数中偶数个5的数的个数

令 $b_n$ 表示 $n$位十进制数中奇数个5的数的个数
\[
    a_n=9 \cdot a_{n-1}+b_{n-1}
    b_n=9 \cdot b_{n-1}+a_{n-1}
\]

母函数小结：

母函数建立了一个序列与递推关系的桥梁。

# Chapter 4: 线性常系数递推关系


Fibonacci 递推关系：
\[
    F_n = F_{n-1}+F_{n-2}
\]

Fibonacci 恒等关系式：
\[
    F_1^2+F_2^1+···+F_n^2=F_nF_{n=1}
\]
\[
    F_1+F_2+···+F_n=F_{n+2}-1
\]
\[
    F_1+F_3+···+F_{2n-1}=F_{2n}
\]
\[
    F_{n-1}F_{n+1} -F_n^2= (-1)^n
\]

Fibonacci 通项直接计算方法：

母函数法

Fibonacci优选法

#### 线性常系数其次递推关系

递推多项式产生特征多项式

特征多项式根的情况：

+ 无重根
+ 有重根
+ 无实根

# Chapter 4: 神奇的序列

### Catalan数

递推关系：

\[
C(n) = \sum_{k=1}^n C(k-1) \cdot C(n-k)
\]

解析表达式：
\[
C(n)=\frac{1}{n+1} \dbinom{2n}{n}
\]
栈混洗模型

二叉树个数计数问题

正多边形划分为不重叠的三角形计数问题

Dyck Path

Dyck Word （括号匹配）
